<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Working with validate | The Data Validation Cookbook</title>
  <meta name="description" content="Chapter 7 Working with validate | The Data Validation Cookbook" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Working with validate | The Data Validation Cookbook" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Working with validate | The Data Validation Cookbook" />
  
  
  

<meta name="author" content="Mark P.J. van der Loo" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sect-indicators.html"/>
<link rel="next" href="sect-rulefiles.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Validation Cookbook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#citing-this-work"><i class="fa fa-check"></i>Citing this work</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="sect-intro.html"><a href="sect-intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to validate</a><ul>
<li class="chapter" data-level="1.1" data-path="sect-intro.html"><a href="sect-intro.html#a-quick-example"><i class="fa fa-check"></i><b>1.1</b> A quick example</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="sect-varlevelchecks.html"><a href="sect-varlevelchecks.html"><i class="fa fa-check"></i><b>2</b> Variable checks</a><ul>
<li class="chapter" data-level="2.1" data-path="sect-varlevelchecks.html"><a href="sect-varlevelchecks.html#variable-type"><i class="fa fa-check"></i><b>2.1</b> Variable type</a></li>
<li class="chapter" data-level="2.2" data-path="sect-varlevelchecks.html"><a href="sect-varlevelchecks.html#sect:missingness"><i class="fa fa-check"></i><b>2.2</b> Missingness</a></li>
<li class="chapter" data-level="2.3" data-path="sect-varlevelchecks.html"><a href="sect-varlevelchecks.html#field-length"><i class="fa fa-check"></i><b>2.3</b> Field length</a></li>
<li class="chapter" data-level="2.4" data-path="sect-varlevelchecks.html"><a href="sect-varlevelchecks.html#format-of-numeric-fields"><i class="fa fa-check"></i><b>2.4</b> Format of numeric fields</a></li>
<li class="chapter" data-level="2.5" data-path="sect-varlevelchecks.html"><a href="sect-varlevelchecks.html#general-field-format"><i class="fa fa-check"></i><b>2.5</b> General field format</a></li>
<li class="chapter" data-level="2.6" data-path="sect-varlevelchecks.html"><a href="sect-varlevelchecks.html#numeric-ranges"><i class="fa fa-check"></i><b>2.6</b> Numeric ranges</a></li>
<li class="chapter" data-level="2.7" data-path="sect-varlevelchecks.html"><a href="sect-varlevelchecks.html#ranges-for-times-and-periods"><i class="fa fa-check"></i><b>2.7</b> Ranges for times and periods</a></li>
<li class="chapter" data-level="2.8" data-path="sect-varlevelchecks.html"><a href="sect-varlevelchecks.html#code-lists"><i class="fa fa-check"></i><b>2.8</b> Code lists</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sect-availableunique.html"><a href="sect-availableunique.html"><i class="fa fa-check"></i><b>3</b> Availability and uniqueness</a><ul>
<li class="chapter" data-level="3.1" data-path="sect-availableunique.html"><a href="sect-availableunique.html#long-data"><i class="fa fa-check"></i><b>3.1</b> Long data</a></li>
<li class="chapter" data-level="3.2" data-path="sect-availableunique.html"><a href="sect-availableunique.html#sect:uniqueness"><i class="fa fa-check"></i><b>3.2</b> Uniqueness</a></li>
<li class="chapter" data-level="3.3" data-path="sect-availableunique.html"><a href="sect-availableunique.html#sect:completeness"><i class="fa fa-check"></i><b>3.3</b> Availability of records</a></li>
<li class="chapter" data-level="3.4" data-path="sect-availableunique.html"><a href="sect-availableunique.html#gaps-in-time-series"><i class="fa fa-check"></i><b>3.4</b> Gaps in (time) series</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multivariate-checks.html"><a href="multivariate-checks.html"><i class="fa fa-check"></i><b>4</b> Multivariate checks</a><ul>
<li class="chapter" data-level="4.1" data-path="multivariate-checks.html"><a href="multivariate-checks.html#sect:iscomplete"><i class="fa fa-check"></i><b>4.1</b> Completeness of records</a></li>
<li class="chapter" data-level="4.2" data-path="multivariate-checks.html"><a href="multivariate-checks.html#balance-equalities-and-inequalities"><i class="fa fa-check"></i><b>4.2</b> Balance equalities and inequalities</a></li>
<li class="chapter" data-level="4.3" data-path="multivariate-checks.html"><a href="multivariate-checks.html#conditional-restrictions"><i class="fa fa-check"></i><b>4.3</b> Conditional restrictions</a></li>
<li class="chapter" data-level="4.4" data-path="multivariate-checks.html"><a href="multivariate-checks.html#forbidden-value-combinations"><i class="fa fa-check"></i><b>4.4</b> Forbidden value combinations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sect-statisticalchecks.html"><a href="sect-statisticalchecks.html"><i class="fa fa-check"></i><b>5</b> Statistical checks</a><ul>
<li class="chapter" data-level="5.1" data-path="sect-statisticalchecks.html"><a href="sect-statisticalchecks.html#sect:groupwise"><i class="fa fa-check"></i><b>5.1</b> Statistical and groupwise characteristics</a></li>
<li class="chapter" data-level="5.2" data-path="sect-statisticalchecks.html"><a href="sect-statisticalchecks.html#group-properties"><i class="fa fa-check"></i><b>5.2</b> Group properties</a></li>
<li class="chapter" data-level="5.3" data-path="sect-statisticalchecks.html"><a href="sect-statisticalchecks.html#code-hierarchies-and-aggregation"><i class="fa fa-check"></i><b>5.3</b> Code hierarchies and aggregation</a></li>
<li class="chapter" data-level="5.4" data-path="sect-statisticalchecks.html"><a href="sect-statisticalchecks.html#general-aggregates-in-long-form-data"><i class="fa fa-check"></i><b>5.4</b> General aggregates in long-form data</a><ul>
<li class="chapter" data-level="" data-path="sect-statisticalchecks.html"><a href="sect-statisticalchecks.html#notes"><i class="fa fa-check"></i>Notes</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="sect-statisticalchecks.html"><a href="sect-statisticalchecks.html#aggregates-of-time-series-in-long-format"><i class="fa fa-check"></i><b>5.5</b> Aggregates of time series in long format</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sect-indicators.html"><a href="sect-indicators.html"><i class="fa fa-check"></i><b>6</b> Indicators</a><ul>
<li class="chapter" data-level="6.1" data-path="sect-indicators.html"><a href="sect-indicators.html#a-first-example"><i class="fa fa-check"></i><b>6.1</b> A first example</a></li>
<li class="chapter" data-level="6.2" data-path="sect-indicators.html"><a href="sect-indicators.html#getting-indicator-values"><i class="fa fa-check"></i><b>6.2</b> Getting indicator values</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sect-work.html"><a href="sect-work.html"><i class="fa fa-check"></i><b>7</b> Working with validate</a><ul>
<li class="chapter" data-level="7.1" data-path="sect-work.html"><a href="sect-work.html#sect:readfromfile"><i class="fa fa-check"></i><b>7.1</b> Reading rules from file</a></li>
<li class="chapter" data-level="7.2" data-path="sect-work.html"><a href="sect-work.html#manipulating-rule-sets"><i class="fa fa-check"></i><b>7.2</b> Manipulating rule sets</a></li>
<li class="chapter" data-level="7.3" data-path="sect-work.html"><a href="sect-work.html#rule-metadata"><i class="fa fa-check"></i><b>7.3</b> Rule metadata</a></li>
<li class="chapter" data-level="7.4" data-path="sect-work.html"><a href="sect-work.html#sect:yamlfiles"><i class="fa fa-check"></i><b>7.4</b> Metadata in text files: <code>YAML</code></a></li>
<li class="chapter" data-level="7.5" data-path="sect-work.html"><a href="sect-work.html#rules-in-data-frames"><i class="fa fa-check"></i><b>7.5</b> Rules in data frames</a></li>
<li class="chapter" data-level="7.6" data-path="sect-work.html"><a href="sect-work.html#sect:syntax"><i class="fa fa-check"></i><b>7.6</b> Validation rule syntax</a></li>
<li class="chapter" data-level="7.7" data-path="sect-work.html"><a href="sect-work.html#confrontation-objects"><i class="fa fa-check"></i><b>7.7</b> Confrontation objects</a></li>
<li class="chapter" data-level="7.8" data-path="sect-work.html"><a href="sect-work.html#sect:options"><i class="fa fa-check"></i><b>7.8</b> Confrontation options</a></li>
<li class="chapter" data-level="7.9" data-path="sect-work.html"><a href="sect-work.html#using-reference-data"><i class="fa fa-check"></i><b>7.9</b> Using reference data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sect-rulefiles.html"><a href="sect-rulefiles.html"><i class="fa fa-check"></i><b>8</b> Rules in text files</a><ul>
<li class="chapter" data-level="8.1" data-path="sect-rulefiles.html"><a href="sect-rulefiles.html#setting-options"><i class="fa fa-check"></i><b>8.1</b> Setting options</a></li>
<li class="chapter" data-level="8.2" data-path="sect-rulefiles.html"><a href="sect-rulefiles.html#including-other-rule-files"><i class="fa fa-check"></i><b>8.2</b> Including other rule files</a></li>
<li class="chapter" data-level="8.3" data-path="sect-rulefiles.html"><a href="sect-rulefiles.html#exporting-validator-objects"><i class="fa fa-check"></i><b>8.3</b> Exporting validator objects</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sect-comparing.html"><a href="sect-comparing.html"><i class="fa fa-check"></i><b>9</b> Comparing data sets</a><ul>
<li class="chapter" data-level="9.1" data-path="sect-comparing.html"><a href="sect-comparing.html#cell-counts"><i class="fa fa-check"></i><b>9.1</b> Cell counts</a></li>
<li class="chapter" data-level="9.2" data-path="sect-comparing.html"><a href="sect-comparing.html#comparing-rule-violations"><i class="fa fa-check"></i><b>9.2</b> Comparing rule violations</a></li>
<li class="chapter" data-level="9.3" data-path="sect-comparing.html"><a href="sect-comparing.html#validate-and-lumberjack"><i class="fa fa-check"></i><b>9.3</b> <code>validate</code> and <code>lumberjack</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliographical-notes.html"><a href="bibliographical-notes.html"><i class="fa fa-check"></i>Bibliographical notes</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Data Validation Cookbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect:work" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Working with validate</h1>
<div id="sect:readfromfile" class="section level2">
<h2><span class="header-section-number">7.1</span> Reading rules from file</h2>
<p>It is a very good idea to store and maintain rule sets outside of your R
script. Validate supports two file formats: simple text files and <code>yaml</code> files.
Here we only discuss simple text files, yaml files are treated in <a href="sect-work.html#sect:yamlfiles">7.4</a>.</p>
<p>To try this, copy the following rules into a new text file and store it in a
file called <code>myrules.R</code>, in the current working directory of your R session.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" title="1"><span class="co"># basic range checks</span></a>
<a class="sourceLine" id="cb208-2" title="2">speed <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb208-3" title="3">dist  <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb208-4" title="4"></a>
<a class="sourceLine" id="cb208-5" title="5"><span class="co"># ratio check</span></a>
<a class="sourceLine" id="cb208-6" title="6">speed <span class="op">/</span><span class="st"> </span>dist <span class="op">&lt;=</span><span class="st"> </span><span class="fl">1.5</span></a></code></pre></div>
<p>Note that you are allowed to annotate the rules as you would with
regular R code. Reading these rules can be done as follows.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" title="1">rules &lt;-<span class="st"> </span><span class="kw">validator</span>(<span class="dt">.file=</span><span class="st">&quot;myrules.R&quot;</span>)</a></code></pre></div>
</div>
<div id="manipulating-rule-sets" class="section level2">
<h2><span class="header-section-number">7.2</span> Manipulating rule sets</h2>
<p>Validate stores rulesets into something called a <code>validator</code> object. The
<code>validator()</code> function creates such an object.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" title="1">v &lt;-<span class="st"> </span><span class="kw">validator</span>(speed <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>, dist<span class="op">&gt;=</span><span class="dv">0</span>, speed<span class="op">/</span>dist <span class="op">&lt;=</span><span class="st"> </span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb210-2" title="2">v</a></code></pre></div>
<pre><code>## Object of class &#39;validator&#39; with 3 elements:
##  V1: speed &gt;= 0
##  V2: dist &gt;= 0
##  V3: speed/dist &lt;= 1.5</code></pre>
<p>Validator objects behave a lot like lists. For example, you can select items
to get a new <code>validator</code>. Here, we select the first and third element.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" title="1">w &lt;-<span class="st"> </span>v[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</a></code></pre></div>
<p>Here <code>w</code> is a new validator object holding only the first and third rule from
<code>v</code>. If not specified by the user, rules are given the default names <code>"V1"</code>,
<code>"V2"</code>, and so on. Those names can also be used for selecting rules.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" title="1">w &lt;-<span class="st"> </span>v[<span class="kw">c</span>(<span class="st">&quot;V1&quot;</span>,<span class="st">&quot;V3&quot;</span>)]</a></code></pre></div>
<p>Validator objects are reference objects. This means that if you do</p>
<pre><code>w &lt;- v</code></pre>
<p>then <code>w</code> is not a copy of <code>v</code>. It is just another name for the same physical
object as <code>v</code>. To make an actual copy, you can select everything.</p>
<pre><code>w &lt;- v[]</code></pre>
<p>It is also possible to concatenate two validator objects. For example when you
read two rule sets from two files (See <a href="sect-work.html#sect:readfromfile">7.1</a>). This is done
by adding them together with <code>+</code>.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" title="1">rules1 &lt;-<span class="st"> </span><span class="kw">validator</span>(speed<span class="op">&gt;=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb216-2" title="2">rules2 &lt;-<span class="st"> </span><span class="kw">validator</span>(dist <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb216-3" title="3">all_rules &lt;-<span class="st"> </span>rules1 <span class="op">+</span><span class="st"> </span>rules2</a></code></pre></div>
<p>An empty validator object is created with <code>validator()</code>.</p>
<p>If you select a single element of a validator object, an object of class ‘rule’
is returned. This is the validating expression entered by the user, plus some
(optional) metadata.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" title="1">v[[<span class="dv">3</span>]]</a></code></pre></div>
<pre><code>## 
## Object of class rule.
##  expr       : speed/dist &lt;= 1.5 
##  name       : V3 
##  label      :  
##  description:  
##  origin     : command-line 
##  created    : 2020-12-07 21:35:04
##  meta       : language&lt;chr&gt;, severity&lt;chr&gt;</code></pre>
<p>Users never need to manipulate rule objects, but it can be convenient to
inspect them. As you see, the rules have some automatically created metadata.
In the next section we demonstrate how to retrieve and set the metadata.</p>
</div>
<div id="rule-metadata" class="section level2">
<h2><span class="header-section-number">7.3</span> Rule metadata</h2>
<p>Validator objects behave a lot like lists. The only metadata in an R
list are the <code>names</code> of its elements. You can get and set names of a list
using the <code>names&lt;-</code> function. Similarly, there are getter/setter functions
for rule metadata.</p>
<ul>
<li><code>origin()</code> : Where was a rule defined?</li>
<li><code>names()</code> : The name per rule</li>
<li><code>created()</code> : when were the rules created?</li>
<li><code>label()</code> : Short description of the rule</li>
<li><code>description()</code>: Long description of the rule</li>
<li><code>meta()</code> : Set or get generic metadata</li>
</ul>
<p>Names can be set on the command line, just like how you would do it for
an R list.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" title="1">rules &lt;-<span class="st"> </span><span class="kw">validator</span>(<span class="dt">positive_speed =</span> speed <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>, <span class="dt">ratio =</span> speed<span class="op">/</span>dist <span class="op">&lt;=</span><span class="st"> </span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb219-2" title="2">rules</a></code></pre></div>
<pre><code>## Object of class &#39;validator&#39; with 2 elements:
##  positive_speed: speed &gt;= 0
##  ratio         : speed/dist &lt;= 1.5</code></pre>
<p>Getting and setting names works the same as for lists.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" title="1"><span class="kw">names</span>(rules)</a></code></pre></div>
<pre><code>## [1] &quot;positive_speed&quot; &quot;ratio&quot;</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" title="1"><span class="kw">names</span>(rules)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;nonnegative_speed&quot;</span></a></code></pre></div>
<p>The functions <code>origin()</code>, <code>created()</code>, <code>label()</code>, and <code>description()</code> work in
the same way. It is also possible to add generic key-value pairs as metadata.
Getting and setting follows the usual recycling rules of R.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" title="1"><span class="co"># add &#39;foo&#39; to the first rule:</span></a>
<a class="sourceLine" id="cb224-2" title="2"><span class="kw">meta</span>(rules[<span class="dv">1</span>],<span class="st">&quot;foo&quot;</span>) &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb224-3" title="3"><span class="co"># Add &#39;bar&#39; to all rules</span></a>
<a class="sourceLine" id="cb224-4" title="4"><span class="kw">meta</span>(rules,<span class="st">&quot;bar&quot;</span>) &lt;-<span class="st"> &quot;baz&quot;</span></a></code></pre></div>
<p>Metadata can be made visible by selecting a single rule:</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" title="1">v[[<span class="dv">1</span>]]</a></code></pre></div>
<pre><code>## 
## Object of class rule.
##  expr       : speed &gt;= 0 
##  name       : V1 
##  label      :  
##  description:  
##  origin     : command-line 
##  created    : 2020-12-07 21:35:04
##  meta       : language&lt;chr&gt;, severity&lt;chr&gt;</code></pre>
<p>Or by extracting it to a <code>data.frame</code></p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" title="1"><span class="kw">meta</span>(v)</a></code></pre></div>
<pre><code>##   name label description       origin             created          language
## 1   V1                   command-line 2020-12-07 21:35:04 validate 0.9.3.44
## 2   V2                   command-line 2020-12-07 21:35:04 validate 0.9.3.44
## 3   V3                   command-line 2020-12-07 21:35:04 validate 0.9.3.44
##   severity
## 1    error
## 2    error
## 3    error</code></pre>
<p>Some general information is obtained with <code>summary</code>,</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" title="1"><span class="kw">summary</span>(v)</a></code></pre></div>
<pre><code>##   block nvar rules linear
## 1     1    2     3      2</code></pre>
<p>Here, some properties per <em>block</em> of rules is given. Two rules occur in the same
block if when they share a variable. In this case, all rules occur in the same
block.</p>
<p>The number of rules can be requested with <code>length</code></p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" title="1"><span class="kw">length</span>(v)</a></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>With <code>variables</code>, the variables occurring per rule, or over all the rules can be requested.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb233-1" title="1"><span class="kw">variables</span>(v)</a></code></pre></div>
<pre><code>## [1] &quot;speed&quot; &quot;dist&quot;</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb235-1" title="1"><span class="kw">variables</span>(v,<span class="dt">as=</span><span class="st">&quot;matrix&quot;</span>)</a></code></pre></div>
<pre><code>##     variable
## rule speed  dist
##   V1  TRUE FALSE
##   V2 FALSE  TRUE
##   V3  TRUE  TRUE</code></pre>
</div>
<div id="sect:yamlfiles" class="section level2">
<h2><span class="header-section-number">7.4</span> Metadata in text files: <code>YAML</code></h2>
<p><a href="https://yaml.org">YAML</a> is a data format that aims to be easy to learn and
human-readable. The name ‘YAML’ is a <a href="https://en.wikipedia.org/wiki/Recursive_acronym">recursive
acronym</a> that stands for</p>
<blockquote>
<p>YAML Ain’t Markup Language.</p>
</blockquote>
<p>Validate can read and write rule sets from and to YAML files. For example,
paste the following code into a file called <code>myrules.yaml</code>.</p>
<pre><code>rules:
- expr: speed &gt;= 0
  name: &#39;speed&#39;
  label: &#39;speed positivity&#39;
  description: |
    speed can not be negative
  created: 2020-11-02 11:15:11
  meta:
    language: validate 0.9.3.36
    severity: error
- expr: dist &gt;= 0
  name: &#39;dist&#39;
  label: &#39;distance positivity&#39;
  description: |
    distance cannot be negative.
  created: 2020-11-02 11:15:11
  meta:
    language: validate 0.9.3.36
    severity: error
- expr: speed/dist &lt;= 1.5
  name: &#39;ratio&#39;
  label: &#39;ratio limit&#39;
  description: | 
    The speed to distance ratio can
    not exceed 1.5.
  created: 2020-11-02 11:15:11
  meta:
    language: validate 0.9.3.36
    severity: error
</code></pre>
<p>We can read this file using <code>validator(.file=)</code> as before.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb238-1" title="1">rules &lt;-<span class="st"> </span><span class="kw">validator</span>(<span class="dt">.file=</span><span class="st">&quot;myrules.yaml&quot;</span>)</a>
<a class="sourceLine" id="cb238-2" title="2">rules</a></code></pre></div>
<pre><code>## Object of class &#39;validator&#39; with 3 elements:
##  speed [speed positivity]  : speed &gt;= 0
##  dist [distance positivity]: dist &gt;= 0
##  ratio [ratio limit]       : speed/dist &lt;= 1.5</code></pre>
<p>Observe that the labels are printed between brackets. There are a few things
to note about these YAML files.</p>
<ol style="list-style-type: decimal">
<li><code>rules:</code> starts a list of rules.</li>
<li>Each new rule starts with a dash (<code>-</code>)</li>
<li>Each element of a rule is denoted <code>name: &lt;content&gt;</code>. The only obligated
element is <code>expr</code>: the rule expression.</li>
<li>Spaces matter. Each element of a rule must be preceded by a newline and two spaces.
Subelements (as in <code>meta</code>) are indented again.</li>
</ol>
<p>A full tutorial on YAML can be found at
<a href="https://www.w3schools.io/file/yaml-introduction/">W3Cschools.io</a>.</p>
<p>To export a rule set to yaml, use the <code>export_yaml()</code> function.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb240-1" title="1">rules1 &lt;-<span class="st"> </span>rules[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</a>
<a class="sourceLine" id="cb240-2" title="2"><span class="kw">export_yaml</span>(rules1, <span class="dt">file=</span><span class="st">&quot;myrules2.yaml&quot;</span>)</a></code></pre></div>
<p>We will return extensively to reading rules from YAML or other text files
in Chapter <a href="sect-rulefiles.html#sect:rulefiles">8</a>.</p>
</div>
<div id="rules-in-data-frames" class="section level2">
<h2><span class="header-section-number">7.5</span> Rules in data frames</h2>
<p>You can read and write rules and their metadata from and to data frames. This
is convenient, for example in cases where rules are retrieved from a central
rule repository in a data base.</p>
<p>Exporting rules and their metadata can be done with <code>as.data.frame</code>.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb241-1" title="1">rules &lt;-<span class="st"> </span><span class="kw">validator</span>(speed <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>, dist <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>, speed<span class="op">/</span>dist <span class="op">&lt;=</span><span class="st"> </span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb241-2" title="2">df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(rules)</a></code></pre></div>
<p>Reading from a data frame is done through the <code>.data</code> argument.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb242-1" title="1">rules &lt;-<span class="st"> </span><span class="kw">validator</span>(<span class="dt">.data=</span>df)</a></code></pre></div>
<p>It is not necessary to define all possible metadata in the data frame. It is
sufficient to have three character columns, named <code>rule</code>, <code>name</code> and
<code>description</code> in any order.</p>
</div>
<div id="sect:syntax" class="section level2">
<h2><span class="header-section-number">7.6</span> Validation rule syntax</h2>
<p>Conceptually, any R statement that will evaluate to a <code>logical</code> is considered a
validating statement. The validate package checks this when the user defines a
rule set, so for example calling <code>validator( mean(height) )</code> will result in a
warning since just computing <code>mean(x)</code> does not validate anything.</p>
<p>You will find a concise description of the syntax in the <code>syntax</code> help file.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb243-1" title="1">?syntax</a></code></pre></div>
<p>In short, you can use</p>
<ul>
<li>Type checks: any function starting with <code>is.</code></li>
<li>Binary comparisons: <code>&lt;, &lt;=, ==, !=, &gt;=, &gt;</code> and <code>%in%</code></li>
<li>Unary logical operators: <code>!, all(), any()</code></li>
<li>Binary logical operators: <code>&amp;, &amp;&amp;, |, ||</code> and logical implication, e.g. <code>if (staff &gt; 0) staff.costs &gt; 0</code></li>
<li>Pattern matching <code>grepl</code></li>
<li><a href="https://en.wikipedia.org/wiki/Functional_dependency">Functional dependency</a>: <span class="math inline">\(X\to Y + Z\)</span> is represented by <code>X ~ Y + Z</code>.</li>
</ul>
<p>There are some extra syntax elements that help in defining complex rules.</p>
<ul>
<li>Inspect the whole data set using <code>.</code>, e.g. <code>validator( nrow(.) &gt; 10)</code>.</li>
<li>Reuse a variable using <code>:=</code>, e.g. <code>validator(m := mean(x), x &lt; 2*m )</code>.</li>
<li>Apply the same rule to multiple groups with <code>var_group</code>. For example
<code>validator(G:=var_group(x,y), G &gt; 0)</code> is equivalent to <code>validator(x&gt;0, y&gt;0)</code>.</li>
</ul>
<p>A few helper functions are available to compute groupwise values on
variables (vectors). They differ from functions like <code>aggregate</code> or <code>tapply</code>
in that their result is always of the same length as the input.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb244-1" title="1"><span class="kw">sum_by</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">by =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>), <span class="dt">each=</span><span class="dv">5</span>) )</a></code></pre></div>
<pre><code>##  [1] 15 15 15 15 15 40 40 40 40 40</code></pre>
<p>This is useful for rules where you want to compare individual values with
group aggregates.</p>
<table>
<thead>
<tr class="header">
<th>function</th>
<th>computes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>do_by</code></td>
<td>generic groupwise calculation</td>
</tr>
<tr class="even">
<td><code>sum_by</code></td>
<td>groupwise sum</td>
</tr>
<tr class="odd">
<td><code>min_by</code>, <code>max_by</code></td>
<td>groupwise min, max</td>
</tr>
<tr class="even">
<td><code>mean_by</code></td>
<td>groupwise mean</td>
</tr>
<tr class="odd">
<td><code>median_by</code></td>
<td>groupwise median</td>
</tr>
</tbody>
</table>
<p>See also Section <a href="sect-statisticalchecks.html#sect:groupwise">5.1</a>.</p>
<p>There are a number of functions that perform a particular validation task that
would be hard to express with basic syntax. These are treated extensively
in Chapters <a href="sect-varlevelchecks.html#sect:varlevelchecks">2</a> to <a href="sect-statisticalchecks.html#sect:statisticalchecks">5</a>, but
here is a quick overview.</p>
<table>
<thead>
<tr class="header">
<th>function</th>
<th>checks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>in_range</code></td>
<td>Numeric variable range</td>
</tr>
<tr class="even">
<td><code>is_unique</code></td>
<td>Uniqueness of variable combinations</td>
</tr>
<tr class="odd">
<td><code>all_unique</code></td>
<td>Equivalent to <code>all(is_unique())</code></td>
</tr>
<tr class="even">
<td><code>is_complete</code></td>
<td>Completeness of records</td>
</tr>
<tr class="odd">
<td><code>all_complete</code></td>
<td>Equivalent to <code>all(is_complete())</code></td>
</tr>
<tr class="even">
<td><code>exists_any</code></td>
<td>For each group, check if any record satisfies a rule</td>
</tr>
<tr class="odd">
<td><code>exists_one</code></td>
<td>For each group, check if exactly one record satisfies a rule</td>
</tr>
<tr class="even">
<td><code>is_linear_sequence</code></td>
<td>Linearity of numeric or date/time/period series</td>
</tr>
<tr class="odd">
<td><code>in_linear_sequence</code></td>
<td>Linearity of numeric of date/time/period series</td>
</tr>
<tr class="even">
<td><code>hierarchy</code></td>
<td>Hierarchical aggregations</td>
</tr>
<tr class="odd">
<td><code>part_whole_relation</code></td>
<td>Generic part-whole relations</td>
</tr>
<tr class="even">
<td><code>field_length</code></td>
<td>Field length</td>
</tr>
<tr class="odd">
<td><code>number_format</code></td>
<td>Numeric format in text fields</td>
</tr>
<tr class="even">
<td><code>field_format</code></td>
<td>Field format</td>
</tr>
<tr class="odd">
<td><code>contains_exactly</code></td>
<td>Availability of records</td>
</tr>
<tr class="even">
<td><code>contains_at_least</code></td>
<td>Availability of records</td>
</tr>
<tr class="odd">
<td><code>contains_at_most</code></td>
<td>Availability of records</td>
</tr>
<tr class="even">
<td><code>does_not_contain</code></td>
<td>Correctness of key combinations</td>
</tr>
</tbody>
</table>
</div>
<div id="confrontation-objects" class="section level2">
<h2><span class="header-section-number">7.7</span> Confrontation objects</h2>
<p>The outcome of confronting a validator object with a data set is an object of
class <code>confrontation</code>. There are several ways to extract information from a
<code>confrontation</code> object.</p>
<ul>
<li><code>summary</code>: summarize output; returns a <code>data.frame</code></li>
<li><code>aggregate</code>: aggregate validation in several ways</li>
<li><code>sort</code> : aggregate and sort in several ways</li>
<li><code>values</code>: Get the values in an array, or a list of arrays if rules have different output dimension structure</li>
<li><code>errors</code>: Retrieve error messages caught during the confrontation</li>
<li><code>warnings</code>: Retrieve warning messages caught during the confrontation.</li>
</ul>
<p>By default aggregates are produced by rule.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb246-1" title="1">v  &lt;-<span class="st"> </span><span class="kw">validator</span>(height<span class="op">&gt;</span><span class="dv">0</span>, weight<span class="op">&gt;</span><span class="dv">0</span>,height<span class="op">/</span>weight <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb246-2" title="2">cf &lt;-<span class="st"> </span><span class="kw">confront</span>(women, rules)</a>
<a class="sourceLine" id="cb246-3" title="3"><span class="kw">aggregate</span>(cf) </a></code></pre></div>
<pre><code>## NULL</code></pre>
<p>To aggregate by record, use <code>by='record'</code></p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb248-1" title="1"><span class="kw">head</span>(<span class="kw">aggregate</span>(cf,<span class="dt">by=</span><span class="st">&#39;record&#39;</span>))</a></code></pre></div>
<pre><code>## list()</code></pre>
<p>Aggregated results can be automatically sorted, so records with the most violations or
rules that are violated most sort higher.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb250-1" title="1"><span class="co"># rules with most violations sorting first:</span></a>
<a class="sourceLine" id="cb250-2" title="2"><span class="kw">sort</span>(cf)</a></code></pre></div>
<pre><code>## NULL</code></pre>
<p>Confrontation objects can be subsetted with single bracket operators (like
vectors), to obtain a sub-object pertaining only to the selected rules.</p>
<pre><code>summary(cf[c(1,3)])</code></pre>
</div>
<div id="sect:options" class="section level2">
<h2><span class="header-section-number">7.8</span> Confrontation options</h2>
<p>By default, all errors and warnings are caught when validation rules are confronted with data. This can be switched off by setting the <code>raise</code> option to <code>"errors"</code> or <code>"all"</code>. The following
example contains a specification error: <code>hite</code> should be <code>height</code> and therefore the rule errors
on the <code>women</code> data.frame because it does not contain a column <code>hite</code>. The error is caught
(not resulting in a R error) and shown in the summary,</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb253-1" title="1">v &lt;-<span class="st"> </span><span class="kw">validator</span>(hite <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, weight<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb253-2" title="2"><span class="kw">summary</span>(<span class="kw">confront</span>(women, v))</a></code></pre></div>
<pre><code>##   name items passes fails nNA error warning expression
## 1   V1     0      0     0   0  TRUE   FALSE   hite &gt; 0
## 2   V2    15     15     0   0 FALSE   FALSE weight &gt; 0</code></pre>
<p>Setting <code>raise</code> to <code>all</code> results in a R error:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb255-1" title="1"><span class="co"># this gives an error</span></a>
<a class="sourceLine" id="cb255-2" title="2"><span class="kw">confront</span>(women, v, <span class="dt">raise=</span><span class="st">&#39;all&#39;</span>)</a></code></pre></div>
<pre><code>## Error in fun(...): object &#39;hite&#39; not found</code></pre>
<p>Linear equalities form an important class of validation rules. To prevent
equalities to be strictly tested, there is an option called <code>lin.eq.eps</code> (with
default value <span class="math inline">\(10^{-8}\)</span>) that allows one to add some slack to these tests. The
amount of slack is intended to prevent false negatives (unnecessary failures)
caused by machine rounding. If you want to check whether a sum-rule is
satisfied to within one or two units of measurement, it is cleaner to define
two inequalities for that.</p>
</div>
<div id="using-reference-data" class="section level2">
<h2><span class="header-section-number">7.9</span> Using reference data</h2>
<p>For some checks it is convenient to compare the data under scrutiny with
other data artifacts. Two common examples include:</p>
<ul>
<li>Data is checked against an earlier version of the same dataset.</li>
<li>We wish to check the contents of a column against a code list,
and we do not want to put the code list hard-coded into the
rule set.</li>
</ul>
<p>For this, we can use the <code>ref</code> option in confront. Here is how
to compare columns from two data frames row-by-row. The user
has to make sure that the rows of the data set under scrutiny
(<code>women</code>) matches row-wise with the reference data set (<code>women1</code>).</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb257-1" title="1">women1 &lt;-<span class="st"> </span>women</a>
<a class="sourceLine" id="cb257-2" title="2">rules &lt;-<span class="st"> </span><span class="kw">validator</span>(height <span class="op">==</span><span class="st"> </span>women_reference<span class="op">$</span>height)</a>
<a class="sourceLine" id="cb257-3" title="3">cf &lt;-<span class="st"> </span><span class="kw">confront</span>(women, rules, <span class="dt">ref =</span> <span class="kw">list</span>(<span class="dt">women_reference =</span> women1))</a>
<a class="sourceLine" id="cb257-4" title="4"><span class="kw">summary</span>(cf)</a></code></pre></div>
<pre><code>##   name items passes fails nNA error warning
## 1   V1    15     15     0   0 FALSE   FALSE
##                              expression
## 1 height == women_reference[[&quot;height&quot;]]</code></pre>
<p>Here is how to make a code list available.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb259-1" title="1">rules &lt;-<span class="st"> </span><span class="kw">validator</span>( fruit <span class="op">%in%</span><span class="st"> </span>codelist )</a>
<a class="sourceLine" id="cb259-2" title="2">fruits &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;orange&quot;</span>)</a>
<a class="sourceLine" id="cb259-3" title="3">dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">fruit =</span> <span class="kw">c</span>(<span class="st">&quot;apple&quot;</span>,<span class="st">&quot;broccoli&quot;</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;banana&quot;</span>))</a>
<a class="sourceLine" id="cb259-4" title="4">cf &lt;-<span class="st"> </span><span class="kw">confront</span>(dat, rules, <span class="dt">ref =</span> <span class="kw">list</span>(<span class="dt">codelist =</span> fruits))</a>
<a class="sourceLine" id="cb259-5" title="5"><span class="kw">summary</span>(cf)</a></code></pre></div>
<pre><code>##   name items passes fails nNA error warning           expression
## 1   V1     4      3     1   0 FALSE   FALSE fruit %vin% codelist</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sect-indicators.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect-rulefiles.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["validatecookbook.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
